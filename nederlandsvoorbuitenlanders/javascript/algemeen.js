var english=0;var nederlands=1;var frans=2;var arabisch=3;var turks=4;var spaans=5;var theLanguage=1;var insertExercise=false;var inputSentence="";var sentenceArray=new Array;var sentenceNorm="";var sentenceNormVorigeRonde;var userInputNorm="";var dialogueSoFar="";var guideline="";var unknownWord="";var feedbackSignal=-1;var goedePad=0;var rubbish=false;var capStart=true;var ending="";var stopped=true;var patternSomeChar=/(([a-z]|[A-Z]|ë|é|è|ï|à|ê|[0-9]|@)+)/;var score=new Array;var nrGemaakteStappen;var correctionUsed=false;var node;var node0=0;var node1=1;var node2=2;var node3=3;var node4=4;var node5=5;var node6=6;var node7=7;var node8=8;var node9=9;var node10=10;var node11=11;var node12=12;var node13=13;var node14=14;var node15=15,node16=16,node17=17,node18=18,node19=19;var endnode;var round;var round0=0;var round1=1;var round2=2;var round3=3;var round4=4;var path0=0;var path1=1;var path2=2;var path3=3;function setIntroText(){document.getElementById("inleidendeTekst").innerHTML=introtekst;document.getElementById("inleidingPlaatje").innerHTML=introPlaatje;}function setLanguage(){theLanguage=1;var t=window.location.search;var v=t.slice(1);var found=false;var p="";if(p!=v){for(var x=0;x<6;x++){if(v==x){found=true;}}}if(found){theLanguage=v;}document.vorigeOef.action+="?"+theLanguage;document.volgendeOef.action+="?"+theLanguage;}function emptyInput(str){var str;if(/^( )*$/.test(str)){return true;}else{return false;}}function fillWordsList(){var sep=new Array;var pref=new Array;pref[round0]="";pref[round1]="";pref[round2]="\t- ";pref[round3]=pref[round2];sep[round0]=" - ";sep[round1]=" - ";sep[round2]="\n"+sep2[theLanguage];sep[round3]=sep[round2];for(var iNode=0;iNode<endnode;iNode++){for(var iRound=0;iRound<4;iRound++){allowedWordsArray[iNode][iRound]=allowedWordsArray[iNode][iRound].sort();allowedWordsList[iNode][iRound]=""+pref[iRound]+allowedWordsArray[iNode][iRound][0];for(var k=1;k<allowedWordsArray[iNode][iRound].length;k++){allowedWordsList[iNode][iRound]+=sep[iRound];allowedWordsList[iNode][iRound]+=pref[iRound]+allowedWordsArray[iNode][iRound][k];}}}return false;}function makeInputArray(inputSentence1){var inputSentence1;var endingnr;var sentenceArray1=new Array;var firstLetter;var inputSentenceMinus;if(emptyInput(inputSentence1)){sentenceArray1[0]="";return sentenceArray1;}else{endingnr=inputSentence1.length-1;while(inputSentence1.charAt(endingnr)==" "){endingnr-=1;}}if(endingnr<0){ending="";sentenceArray1[0]="";return sentenceArray1;}else if(inputSentence1.charAt(endingnr)=="."||inputSentence1.charAt(endingnr)=="?"||inputSentence1.charAt(endingnr)=="!"){ending=inputSentence1.charAt(endingnr);inputSentenceMinus=inputSentence1.substring(0,endingnr);}else{ending="";inputSentenceMinus=inputSentence1;}for(i=0;i<endingnr;i++){if(inputSentence1.charAt(i)=="?"){rubbish=true;}}if(patternSomeChar.test(inputSentenceMinus)){sentenceArray1=inputSentenceMinus.match(/(([a-z]|[A-Z]|ë|é|è|ï|à|ê|[0-9]|\'|\.|\-|@))+/g);}else{sentenceArray1=new Array(" ");}firstLetter=sentenceArray1[0].charAt(0);var noCapPattern=/([a-z]|ë|é|è|ï|à|ê)/;if(noCapPattern.test(firstLetter)){capStart=false;}else{capStart=true;}return sentenceArray1;}function makeNormalizedString(sentenceArray1){var sentenceArray1;var outstr="";var wordPlusSpace="";if(sentenceArray1==null){outstr="";}else{for(var i=0;i<sentenceArray1.length;i++){wordPlusSpace=sentenceArray1[i]+" ";outstr+=wordPlusSpace;}}return outstr;}function testForUnknownWords(sentList,phraseList){var OK=false;var found=false;var phraseArray=new Array;var allWordsArray=new Array;for(var i=0;i<phraseList.length&&!OK;i++){phraseArray=phraseList[i].match(/(([a-z]|[A-Z]|ë|é|è|ï|à|ê|[0-9]|\'|\.|\-|@))+/g);allWordsArray=allWordsArray.concat(phraseArray);}unknownWord="";if(sentList[0]==" "){return false;}for(k=0;k<sentList.length&&!found;k++){var OK=false;for(l=0;l<allWordsArray.length&&!OK;l++){if(sentList[k]==allWordsArray[l]){OK=true;}}if(!OK){found=true;unknownWord=sentList[k];}}return false;}function cleanList(phraseList){var cleanedList=new Array;var j=0;for(var i=0;i<phraseList.length;i++){if(phraseList[i]!="\n"){cleanedList[j]=phraseList[i];j++;}}return cleanedList;}function sentenceCovered(sentence,regExpression){if(regExpression.test(sentence)){return true;}else{return false;}}function makeOrRegExp(list){var list;var str;str="(^("+list[0];for(var i=1;i<list.length;i++){str+=" |"+list[i];}str+=" )+)$";return RegExp(str);}function lettereAcute(){document.dialogueform.user.value+="\xE9";document.dialogueform.user.focus();return false;}function lettereGrave(){document.dialogueform.user.value+="\xE8";document.dialogueform.user.focus();return false;}function lettereTrema(){document.dialogueform.user.value+="\xEB";document.dialogueform.user.focus();return false;}function lettereKapje(){document.dialogueform.user.value+="\xEA";document.dialogueform.user.focus();return false;}function letteraGrave(){document.dialogueform.user.value+="\xE0";document.dialogueform.user.focus();return false;}function letteriTrema(){document.dialogueform.user.value+="\xEF";document.dialogueform.user.focus();return false;}function lettereeAcute(){document.dialogueform.user.value+="\xE9";document.dialogueform.user.focus();return false;}function apostrof(){document.dialogueform.user.value+="'";document.dialogueform.user.focus();return false;}function convertDiacriticsOut(str){var str;if(emptyInput(str)){return str;}else{str=str.replace(/@11/g,"\xE8");str=str.replace(/@12/g,"\xE9");str=str.replace(/@13/g,"\xEA");str=str.replace(/@14/g,"\xEB");str=str.replace(/@15/g,"\xEF");str=str.replace(/@16/g,"\xE0");str=str.replace(/@31/g,"'");return str;}return str;}function convertDiacriticsIn(str){var str;if(emptyInput(str)){return str;}else{str=str.replace(/(\350)/g,"@11");str=str.replace(/(\351)/g,"@12");str=str.replace(/(\352)/g,"@13");str=str.replace(/(\353)/g,"@14");str=str.replace(/(\357)/g,"@15");str=str.replace(/(\340)/g,"@16");str=str.replace(/(\')/g,"@31");str=str.replace(/(\´)/g,"@31");str=str.replace(/(\`)/g,"@31");return str;}return str;}function giveTranslations(){document.dialogueform.translations.value=makeTranslations(translations);return false;}function giveBlank(){document.dialogueform.translations.value="";return false;}function makeTranslations(translations1){var translations1;translations1=translations1.sort();var resultString="";for(var i=0;i<translations1.length;i++){resultString+=translations1[i]+"\n";}return resultString;}function startDialogue(){node=node0;round=round0;nrGemaakteStappen=1;stopped=false;fillWordsList();document.dialogueform.user.focus();document.dialogueform.user.value=convertDiacriticsOut(firstWords[node0][round0]);document.dialogueform.wordlist.value=convertDiacriticsOut(allowedWordsList[node0][round0]);document.dialogueform.systeminfo.value="";document.dialogueform.system.value=convertDiacriticsOut(systemUtterance[node0]);dialogueSoFar="";document.resultatenform.resultform.value=dialogueSoFar;document.getElementById("deresultaten").scrollTop=document.getElementById("deresultaten").scrollHeight;return false;}function continueDialogue(){if(stopped){return false;}inputSentence=document.dialogueform.user.value;inputSentence=convertDiacriticsIn(inputSentence);sentenceArray=makeInputArray(inputSentence);sentenceNorm=makeNormalizedString(sentenceArray);if(round==round0){score[nrGemaakteStappen]=100;}else if(round==round1&&!correctionUsed){score[nrGemaakteStappen]=70;}else if(round==round1&&correctionUsed){score[nrGemaakteStappen]=50;}else if(round==round2){score[nrGemaakteStappen]=20;}else{score[nrGemaakteStappen]=10;}testSentence(sentenceNorm);if(feedbackSignal==glRubbish||feedbackSignal==glBeginMetHoofdletter||feedbackSignal==glEmptyInput||feedbackSignal==glPuntVergeten||feedbackSignal==glUnknownWordNotFound||feedbackSignal==glFoutePunt){guideline=line[theLanguage][feedbackSignal];document.dialogueform.systeminfo.value=convertDiacriticsOut(guideline);document.dialogueform.user.focus();}else if(feedbackSignal==glNietVeranderen){guideline=line[theLanguage][feedbackSignal];guideline+=guideline="\n"+"\n"+line[theLanguage][glBeginMet]+" '"+convertDiacriticsOut(firstWords[node][round])+"'";document.dialogueform.systeminfo.value=convertDiacriticsOut(guideline);document.dialogueform.user.value=convertDiacriticsOut(firstWords[node][round]);document.dialogueform.user.focus();}else if(feedbackSignal==glWrongWords){fillLines(glWrongWords,unknownWord);guideline=line[theLanguage][glWrongWords];document.dialogueform.systeminfo.value=convertDiacriticsOut(guideline);document.dialogueform.user.focus();}else if(feedbackSignal==glLongerSentence){fillLines(glJeHebtGetypt,inputSentence);guideline=line[theLanguage][glJeHebtGetypt]+"\n"+line[theLanguage][feedbackSignal];document.dialogueform.systeminfo.value=convertDiacriticsOut(guideline);document.dialogueform.user.focus();}else if(feedbackSignal==glOefMis){stopDialogue();}else if(feedbackSignal==glOK){node=nextNode[node][goedePad];round=0;nrGemaakteStappen++;turn=0;if(node==endnode){finishDialogue();return false;}else{document.dialogueform.user.value=convertDiacriticsOut(firstWords[node][0]);document.dialogueform.user.focus();document.dialogueform.system.value=convertDiacriticsOut(systemUtterance[node]);document.dialogueform.wordlist.value=convertDiacriticsOut(allowedWordsList[node][0]);guideline=line[theLanguage][glOK];document.dialogueform.systeminfo.value=convertDiacriticsOut(guideline);document.resultatenform.resultform.value=convertDiacriticsOut(dialogueSoFar);document.getElementById("deresultaten").scrollTop=document.getElementById("deresultaten").scrollHeight;return false;}}else if(feedbackSignal==glMaarNietGoed0){round++;fillLines(glJeHebtGetypt,inputSentence);guideline=line[theLanguage][glJeHebtGetypt]+" "+line[theLanguage][glMaarNietGoed0]+"\n"+line[theLanguage][glProbeerWeer];document.dialogueform.systeminfo.value=convertDiacriticsOut(guideline);document.dialogueform.user.value=convertDiacriticsOut(firstWords[node][1]);document.dialogueform.user.focus();document.dialogueform.wordlist.value=convertDiacriticsOut(allowedWordsList[node][1]);}else if(feedbackSignal==glMaarNietGoed1){fillLines(glJeHebtGetypt,inputSentence);guideline=line[theLanguage][glJeHebtGetypt]+" "+line[theLanguage][glMaarNietGoed1];guideline+="\n"+line[theLanguage][glGoedAntwoord]+"\n"+allowedWordsList[node][2];if(nrPaths[node]>1){guideline+="\n"+line[theLanguage][glTypOfEnter];}else{guideline+="\n"+line[theLanguage][glEnter];}document.dialogueform.systeminfo.value=convertDiacriticsOut(guideline);document.dialogueform.wordlist.value=convertDiacriticsOut(allowedWordsList[node][1]);document.dialogueform.user.focus();round++;}else if(feedbackSignal==glMaarNietGoed2){fillLines(glJeHebtGetypt,inputSentence);guideline=line[theLanguage][glJeHebtGetypt]+" "+line[theLanguage][glMaarNietGoed1];guideline+="\n"+line[theLanguage][glAntwoordIngevuld];document.dialogueform.systeminfo.value=convertDiacriticsOut(guideline);document.dialogueform.user.value=convertDiacriticsOut(allowedWordsArray[node][2][0]);document.dialogueform.user.focus();document.dialogueform.wordlist.value="";round++;}else if(feedbackSignal==glAntwoordIngevuld){fillLines(glAntwoordIngevuld,inputSentence);guideline=line[theLanguage][glAntwoordIngevuld];document.resultatenform.resultform.value=convertDiacriticsOut(dialogueSoFar);document.getElementById("deresultaten").scrollTop=document.getElementById("deresultaten").scrollHeight;document.dialogueform.systeminfo.value=convertDiacriticsOut(guideline);document.dialogueform.user.value=convertDiacriticsOut(allowedWordsArray[node][2][0]);document.dialogueform.user.focus();document.dialogueform.wordlist.value="";round++;}else if(round>3){round=0;turn=0;stopDialogue();}else{document.resultatenform.resultform.value=convertDiacriticsOut(dialogueSoFar);document.getElementById("deresultaten").scrollTop=document.getElementById("deresultaten").scrollHeight;document.dialogueform.systeminfo.value=convertDiacriticsOut(guideline);}feedbackSignal=-1;return false;}function finishDialogue(){document.dialogueform.user.blur();document.resultatenform.resultform.value=convertDiacriticsOut(dialogueSoFar);document.getElementById("deresultaten").scrollTop=document.getElementById("deresultaten").scrollHeight;document.dialogueform.system.value="";document.dialogueform.user.value="";document.dialogueform.wordlist.value="";var totalscore=0;for(var i=1;i<nrGemaakteStappen;i++){totalscore=totalscore+score[i];}totalscore=totalscore/(nrGemaakteStappen-1);var eindscorestring=""+totalscore;if(totalscore==100){eindscorestring=eindscorestring.slice(0,3);}else{eindscorestring=eindscorestring.slice(0,2);}if(totalscore>80){if(theLanguage==arabisch){guideline=line[theLanguage][glOefKlaar]+"\n\n"+eindscorestring+" / 100"+"  = "+translScore[arabisch];}else{guideline=line[theLanguage][glOefKlaar]+"\n\n"+translScore[theLanguage]+" = "+eindscorestring+" / 100";}}else{if(theLanguage==arabisch){guideline=line[theLanguage][glOefKlaarMaarOver]+"\n\n"+eindscorestring+" / 100"+"  = "+translScore[arabisch];}else{guideline=line[theLanguage][glOefKlaarMaarOver]+"\n\n"+translScore[theLanguage]+" = "+eindscorestring+" / 100";}}document.dialogueform.systeminfo.value=convertDiacriticsOut(guideline);stopped=true;return false;}function stopDialogue(){guideline=line[theLanguage][glOefMis];document.dialogueform.systeminfo.value=convertDiacriticsOut(guideline);document.dialogueform.user.value="";document.dialogueform.user.blur();document.dialogueform.wordlist.value="";stopped=true;return false;}function testSentence(sentenceNorm1){var firstWordsArray=new Array;var emptyFirstWords=false;var emptyAllowedWords=false;var OK=false;feedbackSignal=-1;if(firstWords[node][round]==""||firstWords[node][round]==" "){emptyFirstWords=true;}if(allowedWordsArray[node][round][0]==""||allowedWordsArray[node][round][0]==" "){emptyAllowedWords=true;}if(emptyFirstWords){firstWordsArray=new Array(" ");}else{firstWordsArray=firstWords[node][round].match(/(([a-z]|[A-Z]|ë|é|è|ï|à|ê|[0-9]|\'|\.|\-|@))+/g);}var firstWordsNorm=makeNormalizedString(firstWordsArray);var patternFirstWords=RegExp("(^("+firstWordsNorm+"))");if(rubbish){feedbackSignal=glRubbish;rubbish=false;return false;}else if(!capStart){feedbackSignal=glBeginMetHoofdletter;return false;}else if(sentenceNorm1==firstWordsNorm||sentenceNorm1==""||sentenceNorm1==" "){feedbackSignal=glEmptyInput;return false;}else if(ending==""||ending=="?"){feedbackSignal=glPuntVergeten;return false;}var userInput=sentenceNorm.replace(patternFirstWords,"");var userInputArray=new Array;if(patternSomeChar.test(userInput)){userInputArray=userInput.match(/(([a-z]|[A-Z]|ë|é|è|ï|à|ê|[0-9]|\'|\.|\-|@))+/g);}var userInputNorm=makeNormalizedString(userInputArray);var endnr=userInputNorm.length-1;for(var i=0;i<nrPaths[node]&&!OK;i++){if(isCorrectSentence(sentenceNorm1,node,i)){OK=true;goedePad=i;feedbackSignal=glOK;var sentenceForDialogue=firstWords[node][round]+userInputNorm.substring(0,endnr)+ending;dialogueSoFar=dialogueSoFar+systemUtterance[node]+"\n"+"> "+sentenceForDialogue+"\n";return false;}}if(!OK){if(round<2){if(!patternFirstWords.test(sentenceNorm1)&&!emptyFirstWords&&!insertExercise){feedbackSignal=glNietVeranderen;return false;}else if(!emptyAllowedWords&&!sentenceCovered(userInputNorm,makeOrRegExp(cleanList(allowedWordsArray[node][round])))){for(var i=0;i<allowedWordsArray[node][round].length;i++){}testForUnknownWords(userInputArray,cleanList(allowedWordsArray[node][round]));if(unknownWord==""){feedbackSignal=glUnknownWordNotFound;}else if(unknownWord.charAt(unknownWord.length-1)=="."){feedbackSignal=glFoutePunt;}else{feedbackSignal=glWrongWords;}return false;}else if(shortSentence(sentenceNorm1,node)){feedbackSignal=glLongerSentence;return false;}}if(round==0){feedbackSignal=glMaarNietGoed0;return false;}else if(round==1){feedbackSignal=glMaarNietGoed1;sentenceNormVorigeRonde=sentenceNorm1;return false;}else if(round==2){if(sentenceNormVorigeRonde==sentenceNorm1){feedbackSignal=glAntwoordIngevuld;}else{feedbackSignal=glMaarNietGoed2;}}else if(round==3){feedbackSignal=glOefMis;return false;}return false;}return false;}function shortSentence(sentenceNorm1,argnode){var sentenceNorm1,argnode;return correctShortPattern[argnode].test(sentenceNorm1);}function isCorrectSentence(sentenceNorm1,argnode,argpath){var sentenceNorm1,argnode,argpath;return correctPattern[argnode][argpath].test(sentenceNorm1);}function stopNVB(){var conf=confirm("Wil je echt stoppen?");if(conf){window.close();}}function alertSize(){var myWidth=0,myHeight=0;if(typeof window.innerWidth=="number"){myWidth=window.innerWidth;myHeight=window.innerHeight;}else if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){myWidth=document.documentElement.clientWidth;myHeight=document.documentElement.clientHeight;}else if(document.body&&(document.body.clientWidth||document.body.clientHeight)){myWidth=document.body.clientWidth;myHeight=document.body.clientHeight;}if(myWidth<900){document.getElementById("container").style.left="0";document.getElementById("container").style.marginLeft="0";}}